* POLY-ALA ALPHA CHAIN
*

READ RTF card NAME ~/charmm/top_all22_prot_cmap_csff_brady_group.inp 
READ PARAMETER card NAME ~/charmm/par_all22_prot_cmap_csff_brady_group-test.inp

READ SEQUENCE CARD
* SEGMENT 1 ALPHA CHAIN
*
   9
ALA ALA ALA ALA ALA ALA ALA ALA ALA
GENERATE MAIN SETUP

AUTOGENERATE ANGLE DIHEDRAL

IC PARAMETERS  !Fills any missing values in the internal coordinates table with standard values from the parameter file
IC SEED 1 N 1 CA 1 C
IC BUILD

!
!EVALUATES THE ENERGY
!
ENER CUTNB 99.0 CUTHB 2.5 CUTHA 65. CTONHB 4.0 CTONHA 55. CTOFHB 4.5 -
     CTOFHA 60. CDIE VSWITCH SWITCH

write coor card name "plane.cor"
* Polypeptide in an extended planar conformation
*

!
! SETS ALL THE BACKBONE DIHEDRALS TO ALPHA
!

COOR INIT SELECT ATOM MAIN * * END
IC EDIT
DIHEDRAL 1 N 1 CA 1 C 2 N -44.0
DIHEDRAL 1 C 2 N 2 CA 2 C -67.0
DIHEDRAL 2 N 2 CA 2 C 3 N -44.0
DIHEDRAL 2 C 3 N 3 CA 3 C -67.0
DIHEDRAL 3 N 3 CA 3 C 4 N -44.0
DIHEDRAL 3 C 4 N 4 CA 4 C -67.0
DIHEDRAL 4 N 4 CA 4 C 5 N -44.0
DIHEDRAL 4 C 5 N 5 CA 5 C -67.0
DIHEDRAL 5 N 5 CA 5 C 6 N -44.0
DIHEDRAL 5 C 6 N 6 CA 6 C -67.0
DIHEDRAL 6 N 6 CA 6 C 7 N -44.0
DIHEDRAL 6 C 7 N 7 CA 7 C -67.0
DIHEDRAL 7 N 7 CA 7 C 8 N -44.0
DIHEDRAL 7 C 8 N 8 CA 8 C -67.0
DIHEDRAL 8 N 8 CA 8 C 9 N -44.0
DIHEDRAL 8 C 9 N 9 CA 9 C -67.0
END
IC SEED 1 N 1 CA 1 C
IC BUILD
IC FILL
PRINT IC

write coor card name "alphapolar.cor"
* Polypeptide in an alpha helical conformation
*

!
!HBONDS CUTHB 2.5 CUTHA 65. CTONHB 3.0 CTONHA 55.0 CTOFHB 3.5 CTOFHA 60.0
PRINT HBONDS
ENER CUTNB 99.0

!
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 1 N MAIN 1 CA MAIN 1 C MAIN 2 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 1 C MAIN 2 N MAIN 2 CA MAIN 2 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 2 N MAIN 2 CA MAIN 2 C MAIN 3 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 2 C MAIN 3 N MAIN 3 CA MAIN 3 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 3 N MAIN 3 CA MAIN 3 C MAIN 4 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 3 C MAIN 4 N MAIN 4 CA MAIN 4 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 4 N MAIN 4 CA MAIN 4 C MAIN 5 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 4 C MAIN 5 N MAIN 5 CA MAIN 5 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 5 N MAIN 5 CA MAIN 5 C MAIN 6 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 5 C MAIN 6 N MAIN 6 CA MAIN 6 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 6 N MAIN 6 CA MAIN 6 C MAIN 7 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 6 C MAIN 7 N MAIN 7 CA MAIN 7 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 7 N MAIN 7 CA MAIN 7 C MAIN 8 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 7 C MAIN 8 N MAIN 8 CA MAIN 8 C
CONS DIHE FORCE 15.0 MIN -44.0 MAIN 8 N MAIN 8 CA MAIN 8 C MAIN 9 N
CONS DIHE FORCE 15.0 MIN -67.0 MAIN 8 C MAIN 9 N MAIN 9 CA MAIN 9 C

!
!MINIMIZATION
!
OPEN UNIT 21 WRITE UNFORM NAME coordinates.dcd
MINI SD NSTEP 10 INBFRQ 10 NPRINT 1 STEP 0.005 CUTNB 99.0 SWITCH VSWITCH
!
!DYNA CONJ NSTEP 1000 INBFRQ 50 NPRINT 1 STEP 0.005 CDIE - 
    !CUTNB 99.0 CUTHB 2.5 CUTHA 65. CTONHB 4.0 CTONHA 55. CTOFHB 4.5 -
    !CTOFHA 60. SWITCH VSWITCH TOLENR 0.05 IUNCRD 21
MINI CONJ NSTEP 1000 INBFRQ 50 NPRINT 10 STEP 0.005 CDIE - CUTNB 99.0 CUTHB 2.5 SWITCH TOLENR 0.05
dynamics cpt timestep 0.001 nstep 10 -
firstt 323.0 finalt 323.0 teminc 0.0 -
nprint 1 iprfrq 1 -
pconstant pinternal pmass 400.0 pref 1.0 pgamma 20.0 -
tbath 323.0 tcons -
hoover tmass 1000.0 reft 323.0 -
EWALD PMEWALD KAPPA 0.32  FFTX 90 FFTY 90 FFTZ 90 ORDER 6 -
BYCBim  CUTNB 12.0  CTOFNB 10.0 CTONNB 9.0 -
VDW  VSWITCH NTRFRQ 10 -
inbfrq -1 ihbfrq 0 imgfrq -1 -                       ! heuristic update
iuncrd 21 kunit 22 nsavc 1   ! nsavc is the frq of writing coords
!
CONS CLDH
!
!ENER CUTNB 99.0 CUTHB 2.5 CUTHA 65. CTONHB 4.0 CTONHA 55. CTOFHB 4.5 - 
!     CTOFHA 60. CDIE
!
CONS FIX SELECT .NOT. RESID 3 : 7 ENDS
!
!
HBONDS CUTHB 2.5 CUTHA 65. CTONHB 4.0 CTONHA 55.0 CTOFHB 4.5 CTOFHA 60.0
PRINT HBONDS
COOR HBONDS SELE ALL END SELE ALL END
!ENER CUTNB 99.0 CUTHB 2.5 !CUTHA 65. CTONHB 4.0 CTONHA 55. CTOFHB 4.5 - 
!     CTOFHA 60. CDIE
!
IC FILL 
PRINT IC
!

WRITE COOR CARD name "testcord.cor"
* POLY-ALA ALPHA CHAIN COOR AFTER MINIMIZING.
* CONSTRAINED CONJ. GRADIENT MINIMIZATION
*


!
!
STOP

